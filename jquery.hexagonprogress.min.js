/*!
  jQuery HexagonProgress v1.1.0
  Copyright (c) 2015 http://www.avirtum.com
*/
!function(a){"use strict";function b(a){this.init(a)}b.prototype={size:100,value:0,startAngle:Math.PI/2,lineWidth:null,lineCap:"round",clip:!1,backgroundImage:null,lineBackFill:"rgba(0, 0, 0, .1)",lineFrontFill:{gradient:["#fb141d","#fb0c58"]},animation:{duration:1800,easing:"hexagonEasing"},animationStartValue:0,constructor:b,el:null,canvas:null,ctx:null,outerRadius:0,lineFill:null,lastValue:0,coordBack:[],coordFront:[],edges:[],init:function(b){a.extend(this,b),this.initWidget(),this.initFill(),this.draw()},initWidget:function(){var b=this.canvas=this.canvas||a("<canvas>").prependTo(this.el)[0];if("parent"==this.size){var c=a(b).parent().outerHeight(),d=a(b).parent().outerWidth();this.size=c>d?d:c}b.width=this.size,b.height=this.size,this.ctx=b.getContext("2d"),this.outerRadius=this.size/2},initCoordBack:function(){var a=this.outerRadius,b=this.getLineWidth(),a=a-b/2,c=a*Math.sqrt(3)/2,d=a/2,e=b/2,f=a-a*Math.sqrt(3)/2+b/2,g=d+e,h=0+f,i=g+a,j=h+0,k=i+d,l=j+c,m=k-d,n=l+c,o=m-a,p=n-0,q=o-d,r=p-c,s=[{x:g,y:h},{x:i,y:j},{x:k,y:l},{x:m,y:n},{x:o,y:p},{x:q,y:r},{x:g,y:h}],t=[{x:s[1].x-s[0].x,y:s[1].y-s[0].y},{x:s[2].x-s[1].x,y:s[2].y-s[1].y},{x:s[3].x-s[2].x,y:s[3].y-s[2].y},{x:s[4].x-s[3].x,y:s[4].y-s[3].y},{x:s[5].x-s[4].x,y:s[5].y-s[4].y},{x:s[0].x-s[5].x,y:s[0].y-s[5].y}];this.coordBack=s,this.edges=t},initCoordFront:function(a){var b=(this.outerRadius,this.getLineWidth(),this.startAngle),c=180*b/Math.PI-60,c=Math.abs(c)>360?c-360*Math.floor(c/360):c,c=0>c?360+c:c,d=c+360*a,d=Math.abs(d)>360?d-360*Math.floor(d/360):d,e=Math.floor(c/60)+1,f=Math.floor(d/60)+1,g=Math.abs(60*(e-1)-c)/60,h=Math.abs(60*(f-1)-d)/60,i=Math.floor(a/(1/6)+g)+1,j=[],k=e,l=this.edges[k-1].x*g+this.coordBack[k-1].x,m=this.edges[k-1].y*g+this.coordBack[k-1].y;if(j.push({x:l,y:m}),i>1)for(var n=1;6>=n;n++){if(k==f&&e!=f){l=this.edges[k-1].x*h+this.coordBack[k-1].x,m=this.edges[k-1].y*h+this.coordBack[k-1].y,j.push({x:l,y:m});break}l=this.coordBack[k].x,m=this.coordBack[k].y,j.push({x:l,y:m}),k++,k>6&&(k=1)}k==f&&e==f&&(l=this.edges[k-1].x*h+this.coordBack[k-1].x,m=this.edges[k-1].y*h+this.coordBack[k-1].y,j.push({x:l,y:m})),this.coordFront=j},initFill:function(){function b(){var b=a("<canvas>")[0];b.width=c.size,b.height=c.size,b.getContext("2d").drawImage(n,0,0,f,f),c.lineFill=c.ctx.createPattern(b,"no-repeat"),c.drawFrame(c.lastValue)}var c=this,d=this.lineFrontFill,e=this.ctx,f=this.size;if(!d)throw Error("The lineFrontFill is not specified!");if(d.color&&(this.lineFill=d.color),d.gradient){var g=d.gradient;if(1==g.length)this.lineFill=g[0];else if(g.length>1){for(var h=d.gradientAngle||0,i=d.gradientDirection||[f/2*(1-Math.cos(h)),f/2*(1+Math.sin(h)),f/2*(1+Math.cos(h)),f/2*(1-Math.sin(h))],j=e.createLinearGradient.apply(e,i),k=0;k<g.length;k++){var l=g[k],m=k/(g.length-1);a.isArray(l)&&(m=l[1],l=l[0]),j.addColorStop(m,l)}this.lineFill=j}}if(d.image){var n;d.image instanceof Image?n=d.image:(n=new Image,n.src=d.image),n.complete?b():n.onload=b}},draw:function(){this.animation?this.drawAnimated(this.value):this.drawFrame(this.value)},drawAnimated:function(b){var c=this,d=this.el,e=a(this.canvas);e.stop(!0,!1),d.trigger("hexagon-animation-start"),e.css({animationProgress:0}).animate({animationProgress:1},a.extend({},this.animation,{step:function(a){var e=c.animationStartValue*(1-a)+b*a;c.drawFrame(e),d.trigger("hexagon-animation-progress",[a,e])}})).promise().always(function(){d.trigger("hexagon-animation-end")})},drawFrame:function(a){this.lastValue=a,this.ctx.clearRect(0,0,this.size,this.size),this.initCoordBack(),this.initCoordFront(a),this.backgroundImage?this.drawBackground():(this.drawBack(),this.drawFront())},makeClipMask:function(){var a=this.ctx,b=this.getLineWidth(),c=this.outerRadius,d=b/2;this.outerRadius-=d,this.initCoordBack(),a.save(),a.fillStyle="#fff",a.globalCompositeOperation="destination-in",a.beginPath(),a.moveTo(this.coordBack[0].x+d,this.coordBack[0].y+d);for(var e=0;e<this.coordBack.length;e++)a.lineTo(this.coordBack[e].x+d,this.coordBack[e].y+d);a.closePath(),a.fill(),a.restore(),this.outerRadius=c,this.initCoordBack()},drawBackground:function(){function a(){var a=b.width,e=b.height,f=c.size/a,g=c.size/e,h=g>f?g:f,i=a*h,j=e*h,k=(c.size-i)/2,l=(c.size-j)/2;d.drawImage(b,0,0,b.width,b.height,k,l,i,j),c.clip&&c.makeClipMask.call(c),c.drawBack.call(c),c.drawFront.call(c)}var b,c=this,d=this.ctx;this.getLineWidth();this.backgroundImage instanceof Image?b=backgroundImage:(b=new Image,b.src=this.backgroundImage),b.complete?a():b.onload=a},drawBack:function(){var a=this.ctx,b=this.getLineWidth();a.beginPath(),a.moveTo(this.coordBack[0].x,this.coordBack[0].y);for(var c=0;c<this.coordBack.length;c++)a.lineTo(this.coordBack[c].x,this.coordBack[c].y);a.lineWidth=b,a.strokeStyle=this.lineBackFill,a.closePath(),a.stroke(),a.restore()},drawFront:function(){var a=this.ctx,b=this.getLineWidth();a.save(),a.beginPath(),a.moveTo(this.coordFront[0].x,this.coordFront[0].y);for(var c=0;c<this.coordFront.length;c++)a.lineTo(this.coordFront[c].x,this.coordFront[c].y);a.lineWidth=b,a.strokeStyle=this.lineFill,a.lineCap=this.lineCap,a.stroke(),a.restore()},getLineWidth:function(){return a.isNumeric(this.lineWidth)?this.lineWidth:this.size/14},getValue:function(){return this.value},setValue:function(a){this.animation&&(this.animationStartValue=this.lastFrameValue),this.value=a,this.draw()}},a.hexagonProgress={defaults:b.prototype},a.easing.hexagonEasing=function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b+c:d/2*((b-=2)*b*b+2)+c},a.fn.hexagonProgress=function(c,d){var e="hexagon-progress",f=this.data(e);if("canvas"==c){if(!f)throw Error("Calling 'canvas' method on not initialized instance is forbidden");return f.canvas}if("value"==c){if(!f)throw Error("Calling 'value' method on not initialized instance is forbidden");if("undefined"==typeof d)return f.getValue();var g=arguments[1];return this.each(function(){a(this).data(e).setValue(g)})}return this.each(function(){var d=a(this),f=d.data(e),g=a.isPlainObject(c)?c:{};if(f)f.init(g);else{var h=a.extend({},d.data());"string"==typeof h.lineFrontFill&&(h.lineFrontFill=JSON.parse(h.lineFrontFill)),"string"==typeof h.animation&&(h.animation=JSON.parse(h.animation)),g=a.extend(h,g),g.el=d,f=new b(g),d.data(e,f)}})}}(window.jQuery);